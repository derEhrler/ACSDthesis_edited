\begin{tikzpicture}[scale=1.4, every node/.style={scale=1.4}] 
% scale everything by factor 1.4 ^

\tikzstyle{sc} 		= [color = black] % shortcut for setting color to black
\tikzstyle{arrow} 	= [thick, color = black, -latex] % define standard arrow
\tikzstyle{sum} 	= [draw, shape = circle] % define summation symbol
\tikzstyle{dot} 		= [draw, shape = circle, inner sep = 0em, minimum size=0.15em, fill=black]
\tikzstyle{block} 	= [draw, rectangle, minimum height = 2em, minimum width = 2em] % define block
\tikzstyle{LLbox}	= [draw, rectangle, minimum height = 2em, minimum width = 4em, text width = 4em, align = center]

% define origin and High-Level MPC block with arrow
\node(tmp)[] at (0,0){}; 
\node(uRef)[block, minimum width=5em, minimum height=3.5em, text width=5em, align=center] at (0,0){High-Level MPC $\bar{\mathcal{S}}^{T}$};
\draw[arrow](uRef)++(0,4em)--(uRef) node[pos=0.4, left]{$r$};

% define auxiliary nodes
\node(aux1)[dot,minimum size=0.2em,right of=uRef, node distance=5.25em]{};
\node(auxN)[below of=aux1, node distance=9em]{};

% individual gains \alpha
\node(a1)[block,sc,right of=aux1,node distance=2.5em]{$\alpha_{1}$};
\node(aN)[block,sc,right of=auxN,node distance=2.5em]{$\alpha_{N}$};

% low level reference blocks
\node(r1)[block,sc,above of=a1,node distance=3.5em]{$\hat{\mathcal{S}}_{1}$};
\node(rN)[block,sc,above of=aN,node distance=3.5em]{$\hat{\mathcal{S}}_{N}$};

% LL MPC blocks
\node(l1)[LLbox,sc,right of=r1,node distance=5.5em]{LL MPC};
\node(lN)[LLbox,sc,right of=rN,node distance=5.5em]{LL MPC};

% summations
\node(s1)[sum,sc,right of=l1, node distance=5em, yshift=-3.5em]{};
\node(sN)[sum,sc,right of=lN, node distance=5em, yshift=-3.5em]{};

% arrows
\draw[arrow](l1)++(0,-3.5em)node[dot]{}--(l1);
\draw[arrow](lN)++(0,-3.5em)node[dot]{}--(lN);

\draw[arrow](a1)--(s1.west)node[below left]{\tiny +};
\draw[arrow](aN)--(sN.west)node[below left]{\tiny +};

\draw[arrow](l1.east)-|(s1.north)node[near start, above]{$\delta u_{1}$}node[above left]{\tiny +};
\draw[arrow](lN.east)-|(sN.north)node[near start, above]{$\delta u_{N}$}node[above left]{\tiny +};

\draw[arrow](a1)--(r1);
\draw[arrow](aN)--(rN);

\draw[arrow](r1)--(l1)node[midway, above]{$\hat{x}_{1}$};
\draw[arrow](rN)--(lN)node[midway, above]{$\hat{x}_{N}$};

\draw[arrow](uRef.east)--(aux1.center)node[pos=0.3, above]{$\bar{u}$}--(a1.west);
\draw[arrow](aux1.center)--(auxN.center)--(aN.west);

% real system blocks
\node(sys1)[block, right of=s1, node distance=3.5em]{$\mathcal{S}_{1}$};
\draw[arrow](s1.east)--(sys1.west) node[midway, above]{$u_{1}$};
\node(sysN)[block, right of=sN, node distance=3.5em]{$\mathcal{S}_{N}$};
\draw[arrow](sN)--(sysN) node[midway, above]{$u_{N}$};

% beta blocks with arrows
\node(b1)[block, right of=sys1, node distance=4em]{$\beta_{1}$};
\draw[arrow](sys1.east)--(b1.west) node[midway, above]{$x_{1}$};
\node(bN)[block, right of=sysN, node distance=4em]{$\beta_{N}$};
\draw[arrow](sysN)--(bN) node[midway, above]{$x_{N}$};

% sum before feedback with arrows
\node(srb)[sum,sc,right of=sys1, node distance=7em]{};
\draw[arrow](b1.east)--(srb.west) node[below left]{\tiny +};
\draw[arrow](bN.east)-|(srb.south) node[below right]{\tiny +};

% dots
\node[sc, below of=a1, node distance=2.5em]{$\vdots$};
\node[sc, below of=a1, node distance=2.5em, xshift=5.5em]{$\vdots$};
\node[sc, below of=sys1, node distance=2.5em]{$\vdots$};
\node[sc, below of=b1, node distance=2.5em]{$\vdots$};

% resampling block with arrows
\node(smp)[block, sc, below of=lN, node distance=7em, minimum width=7em, minimum height=2em, text width=7em, align = center]{Resampling};
\node(tmp1)[right of=srb, node distance=1.5em]{};
\draw[arrow](srb)--(tmp1.center)|-(smp.east)
	node[pos=0.72, above, yshift=-0.2em]{$\bar{x}(\kappa)$};
\draw[arrow](smp.west)-|(uRef.south)
	node[pos=0.4, above, yshift=-0.2em]{$\bar{x}(k)$};

% time scale separation
\draw[thick,dotted](uRef.east)++(1.5em,4.5em)--++(0em,-20em)
	node[left, anchor=south east, xshift=-0.4em, yshift=-0.3em]{\small Slow time scale $T$}
	node[right, anchor=south west, xshift=0.4em, yshift=-0.3em]{\small Fast time scale $\tau$};
\end{tikzpicture}
